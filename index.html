<!DOCTYPE html>

<head>
  <!-- This tells the browser how to read the document. -->
  <meta charset="utf-8">

  <!-- Tells the browser what the title of this page should be. -->
  <title>Resume</title>

  <!-- Load the page styles. -->
  <link href="css/style.css" rel="stylesheet">

  <script src="js/jQuery.js"></script>

  <script src="js/helper.js"></script>

 <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?libraries=places"></script>

  <meta name="viewport" content="width=device-width">
</head>
<body>
  <div id="main">

    <div id="header" class="center-content clear-fix">
      <ul id="topContacts" class="flex-box"></ul>
    </div>
    <div style="clear: both;"></div>

    <div id="workExperience" class="gray">
      <h2>Work Experience</h2>
    </div>
    <div id="projects">
      <h2>Projects</h2>
    </div>
    <div id="education" class="gray">
      <h2>Education</h2>
    </div>
    <div id="mapDiv">
      <h2>Where I've Lived and Worked</h2>
    </div>
    <div id="lets-connect" class="dark-gray">
      <h2 class="orange center-text">Let's Connect</h2>
        <ul id="footerContacts" class="flex-box">
      </ul>
    </div>
  </div>

  <script src="js/resumeBuilder.js"></script>

  <script type="text/javascript">

//define a function which will allow the skills to serve as display filters when clicked
  function filter(skill) {
     $('[data-related-skills*=skill]').addClass('filtered-in');
     $('[data-related-skills]').not('[data-related-skills*=skill]').removeClass('filtered-in');
  }

    bio.display = function(){
      $("#header").prepend(HTMLwelcomeMsg.replace('%data%', bio.message));
      $("#header").prepend(formattedRole);
      $("#header").prepend(formattedBioPic);
      $('#header').prepend(HTMLheaderName.replace('%data%',bio.name));
      $('#footerContacts').append(formattedEmail);
      $('#footerContacts').append(formattedLinkedin);
      $('#footerContacts').append(formattedLocation);
      $('#header').append(HTMLskillsStart);
      var x = 0;
      while (bio.skills.length > x) {
        var currentSkill = bio.skills[x];
        var formattedSkills = HTMLskills.replace('%data%', currentSkill);
        formattedSkills = formattedSkills.replace('%data%', currentSkill);
        $('#skills').append(formattedSkills);
        $('[data-skill=currentSkill]').click(filter(currentSkill));
        console.log([currentSkill]);
//        $('[data-skill=currentSkill]').console.log();
        x++;
      };
    }

    bio.display();

    work.display = function(){
      for (var key in work.jobs) {
        if (work.jobs.hasOwnProperty(key)) {
          $('#workExperience').append(HTMLworkStart);
          /* Create two options for first line of each work-entry - because the freelancer entry does not have 'employer' property. */
          matchJobs = function(duty) {
            if(duty === work.jobs[key]) {
            return true;
          }
        };
        if (Boolean(work.jobs[key].employer) === true) {
            $('.work-entry:last').append((HTMLworkEmployer.replace('%data%' , work.jobs[key].employer))
              + (HTMLworkTitle.replace('%data%' , work.jobs[key].position)));
          } else {
             $('.work-entry:last').append('<a href="#">' + HTMLworkTitle.replace('%data%' , work.jobs[key].position));
          }
          $('.work-entry:last').append(HTMLworkLocation.replace('%data%' , work.jobs[key].city) + HTMLworkYears.replace('%data%' , work.jobs[key].years));
          //add all related job duties to the work-entry -- instead of a description.
            for (dutiesIndex = 0; dutiesIndex < duties.length; dutiesIndex++) {
              if (duties[dutiesIndex].relatedJobs.some(matchJobs)) {
                var formattedDuty = HTMLDuty.replace('%%data%%', duties[dutiesIndex].name);
                formattedDuty = formattedDuty.replace('%data%', duties[dutiesIndex].relatedSkills);
                $('.work-entry:last').append(formattedDuty);
            }
          }
        }
      }
    };

    work.display();

    projects.display = function() {
     for (projectIndex = 0; projectIndex < projects.projectEntries.length; projectIndex++) {
      $('#projects').append(HTMLprojectStart);
      var formattedProjectName = HTMLprojectTitle.replace('%data%' , projects.projectEntries[projectIndex].name);
      formattedProjectName = formattedProjectName.replace('#' , projects.projectEntries[projectIndex].link);
      var formattedProjectImage = HTMLprojectImage.replace('%data%' , projects.projectEntries[projectIndex].image);
      formattedProjectImage = formattedProjectImage.replace('#' , projects.projectEntries[projectIndex].link);
      var formattedProjectChallenge = HTMLprojectChallenge.replace('%data%' , projects.projectEntries[projectIndex].challenge);
      var formattedProjectRole = HTMLprojectRole.replace('%data%' , projects.projectEntries[projectIndex].role);
      $('.project-entry:last').append(formattedProjectImage + formattedProjectName + formattedProjectRole + formattedProjectChallenge);
      };
    }

    projects.display();

  education.display = function (){
    for (schoolsIndex = 0; schoolsIndex < education.schools.length; schoolsIndex++) {
      $('#education').append(HTMLschoolStart);
      var formattedSchoolName = HTMLschoolName.replace('%data%' , education.schools[schoolsIndex].name);
      if (education.schools[schoolsIndex].degree != undefined) {
        var formattedSchoolDegree = HTMLschoolDegree.replace('%data%' , education.schools[schoolsIndex].degree);
      } else {
        var formattedSchoolDegree = "</a>";
      };
      var formattedSchoolDates = HTMLschoolDates.replace('%data%' , education.schools[schoolsIndex].dates);
      var formattedSchoolLocation = HTMLschoolLocation.replace('%data%' , education.schools[schoolsIndex].location);
       if (education.schools[schoolsIndex].major != undefined) {
        var formattedSchoolMajor = HTMLschoolMajor.replace('%data%' , education.schools[schoolsIndex].major);
      } else {
        var formattedSchoolMajor = "";
      };
      var formattedSchoolNotable = HTMLschoolNotable.replace('%data%' , education.schools[schoolsIndex].notable);
      $('.education-entry:last').append(formattedSchoolName + formattedSchoolDegree + formattedSchoolDates + formattedSchoolLocation + formattedSchoolMajor + formattedSchoolNotable);
    };
    $('#education').append(HTMLonlineClasses);
    for (onlinecourseIndex = 0; onlinecourseIndex < education.onlineCourses.length; onlinecourseIndex++) {
        $('#education').append(HTMLschoolStart);
        var formattedOnlineTitle = HTMLonlineTitle.replace('%data%' , education.onlineCourses[onlinecourseIndex].title);
        var formattedOnlineSchool = HTMLonlineSchool.replace('%data%' , education.onlineCourses[onlinecourseIndex].school);
        var formattedOnlineDates = HTMLonlineDates.replace('%data%' , education.onlineCourses[onlinecourseIndex].dates);
        var formattedOnlineURL = HTMLonlineURL.replace('%data%' , education.onlineCourses[onlinecourseIndex].URL);
        $('.education-entry:last').append(formattedOnlineTitle + formattedOnlineSchool + formattedOnlineDates + formattedOnlineURL);
    };
  }

  education.display();

    $('#main').append(internationalizeButton);

    if(document.getElementsByClassName('flex-item').length === 0) {
      document.getElementById('topContacts').style.backgroundColor = 'black';
    }
    if(document.getElementsByTagName('h1').length === 0) {
      document.getElementById('header').style.backgroundColor = 'blue';
    }
    if(document.getElementsByClassName('work-entry').length === 0) {
      document.getElementById('workExperience').style.backgroundColor = 'black';
    }
    if(document.getElementsByClassName('project-entry').length === 0) {
      document.getElementById('projects').style.backgroundColor = 'black';
    }
    if(document.getElementsByClassName('education-entry').length === 0) {
      document.getElementById('education').style.backgroundColor = 'black';
    }
    if(document.getElementsByClassName('flex-item').length === 0) {
      document.getElementById('lets-connect').style.backgroundColor = 'black';
    }
    if(document.getElementById('map') === null) {
      document.getElementById('mapDiv').style.backgroundColor = 'black';
    }

    $(document).click(function(loc) {
      logClicks(event.pageX,event.pageY)
    });

    $("#mapDiv").append(googleMap);

  </script>
</body>
</html>
